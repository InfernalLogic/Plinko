using UnityEngine;

public class PlinkerScript : MonoBehaviour
{
	public float movement_speed = 0f;
  public GameObject new_bomb;
	public Vector2 drop_point_offset = Vector2.zero;

  private bool is_going_right = true;
	private Vector2 movement_vector = Vector2.zero;
	
  // Use this for initialization
  void Start()
  {
		movement_vector.x = movement_speed;
    rigidbody2D.AddForce(movement_vector);

  }

  void FixedUpdate()
  {

  }

  // Update is called once per frame
  void Update()
  {

  }

  void OnCollisionEnter2D(Collision2D collider)
  {
    if (collider.gameObject.tag == "barrier")
    {
      ReverseDirection();
    }
  }

  void ReverseDirection()
  {
    Debug.Log("direction reversed");

    if (is_going_right)
    {
      rigidbody2D.AddForce(movement_vector * -2.0f);
      is_going_right = false;
    }
    else if (!is_going_right)
    {
      rigidbody2D.AddForce(movement_vector * 2.0f);
      is_going_right = true;
    }

		rigidbody2D.velocity = Vector2.ClampMagnitude(rigidbody2D.velocity, movement_speed);
  }

  public void DropBomb()
	//void DropBomb()
  {
    Vector2 drop_point = transform.position;
    drop_point += drop_point_offset;

    Instantiate(new_bomb, drop_point, transform.rotation);

		audio.Play();
  }
}
